<!DOCTYPE html>
<html lang="en"><head>
<link href="../utils/imgs/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <title>Estadística Bayesiana – presentacion_08</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section>
<section id="modelos-jerárquicos" class="title-slide slide level1 center">
<h1>Modelos Jerárquicos</h1>

</section>
<section id="introducción" class="slide level2">
<h2>Introducción</h2>
<p>Consideremos el siguiente modelo: <span class="math display">\[
\begin{align*}
    y\mid\pi &amp; \sim  \mathrm{Bi}(N_i,\pi)\\
    \pi &amp; \sim  Beta(a,b)
\end{align*}
\]</span></p>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<p>Sabemos (gracias al TP2) que la función de densidad de la distribución beta se puede expresar en términos de su moda <span class="math inline">\(\omega\)</span> y su concentración <span class="math inline">\(\kappa\)</span></p>
<p><span class="math display">\[
\begin{align*}
    y\mid\pi &amp; \sim  \mathrm{Bi}(N,\pi)\\
    \pi &amp; \sim  Beta(\omega(\kappa-2)+1,\ (1-\omega)(\kappa-2)+1)
\end{align*}
\]</span></p>
<p>El valor de <span class="math inline">\(\pi\)</span> depende del valor de <span class="math inline">\(\omega\)</span>. Lo sabíamos, después de todo, <span class="math inline">\(\omega\)</span> y <span class="math inline">\(\kappa\)</span> son las <em>constantes de ajuste del prior</em> o <em>hiperparámetros</em>. <span class="math inline">\(\kappa\)</span> refleja el grado de credibilidad <em>a priori</em> sobre los valores de <span class="math inline">\(\pi\)</span> (alrededor de <span class="math inline">\(\omega\)</span>).</p>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<p>¿Qué pasa si <span class="math inline">\(\omega\)</span> no es fijo sino otro parámetro a estimar?</p>
<div class="fragment">
<p>En el contexto de una moneda: <span class="math inline">\(\pi\)</span> es la probabilidad de cara de la moneda y <span class="math inline">\(\omega\)</span> es el valor de probabilidad de cara al que el fabricante de monedas le apunta en la construcción. <span class="math inline">\(\kappa\)</span> (fijo y conocido) es una medida de la dispersión que tiene el proceso de fabricación (de lo consistente que es este proceso) o, en otros términos, mide el grado de asociación entre <span class="math inline">\(\pi\)</span> y <span class="math inline">\(\omega\)</span>.</p>
</div>
<div class="fragment">
<p>¿Qué necesitamos para <span class="math inline">\(\omega\)</span>? Digamos que, <em>a priori</em>, <span class="math inline">\(\omega \sim \mathrm{Beta}(A_\omega,B_\omega)\)</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[
\begin{align*}
    y\mid\pi &amp; \sim  \mathrm{Bi}(N,\pi)\\
    \pi \mid \omega &amp; \sim  \mathrm{Beta}(\omega(\kappa-2)+1,\ (1-\omega)(\kappa-2)+1) \\
    \omega &amp; \sim \mathrm{Beta}(A_\omega,B_\omega)
\end{align*}
\]</span></p>
<p>¿Cuántos parámetros tiene este modelo?</p>
</div>
</section>
<section id="section-2" class="slide level2 smaller">
<h2></h2>
<p>Es un modelo de dos parámetros (hay una distribución conjunta <em>a priori</em> y una distribución conjunta <em>a posteriori</em>) pero no como el <span class="math inline">\(\mu\)</span> y el <span class="math inline">\(\sigma\)</span> de una distribución normal o el <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> de un modelo de regresión lineal…</p>
<p>¿Cómo funciona el modelo hacia adelante? <span class="math inline">\(\omega \rightarrow \pi \rightarrow y\)</span> (<span class="math inline">\(\omega\)</span> influye en el valor de <span class="math inline">\(y\)</span> solo a través de <span class="math inline">\(\pi\)</span>)</p>
<p>¿Y el razonamiento inverso? De <span class="math inline">\(N\)</span> tiradas podemos hacer una inferencia sobre <span class="math inline">\(\pi\)</span>, lo que nos permitirá hacer una inferencia sobre <span class="math inline">\(\omega\)</span></p>
</section>
<section id="section-3" class="slide level2 smaller">
<h2></h2>
<p>¿Qué distribución <em>a posteriori</em> buscamos? <span class="math inline">\(p(\pi,\omega\mid y)\)</span></p>
<p>¿Y la Regla de Bayes? ¿Vale? ¿Cómo la escribimos?</p>
<p><span class="math display">\[p(\pi,\omega\mid y) = \frac{p(y\mid\pi,\omega)p(\pi,\omega)}{p(y)} = \frac{p(y\mid\pi)p(\pi\mid\omega)p(\omega)}{p(y)}\]</span></p>
<p>¿Tenemos forma de expresar <span class="math inline">\(p(y\mid\pi)\)</span>, <span class="math inline">\(p(\pi\mid\omega)\)</span>, y <span class="math inline">\(p(\omega)\)</span>?</p>
</section>
<section id="section-4" class="slide level2">
<h2></h2>
<p>Estamos haciendo inferencia bayesiana sobre una distribución conjunta (de <span class="math inline">\(\pi\)</span> y <span class="math inline">\(\omega\)</span>). Pero la relación entre los parámetros (y la función de verosimilitud) es jerárquica. La jerarquía tiene una interpretación para el modelo.</p>
</section>
<section id="section-5" class="slide level2">
<h2></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>pi <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb1-2"><a></a>omega <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb1-3"><a></a>A_omega <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1-4"><a></a>B_omega <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1-5"><a></a>kappa <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1-6"><a></a>N <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb1-7"><a></a>y <span class="ot">&lt;-</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-6" class="slide level2 smaller">
<h2></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>prior <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">pi =</span> pi, <span class="at">omega =</span> omega) <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a></a>  <span class="fu">mutate</span>(<span class="at">p_omega =</span> <span class="fu">dbeta</span>(omega, A_omega, B_omega),</span>
<span id="cb2-3"><a></a>         <span class="at">p_pi_given_omega =</span> <span class="fu">dbeta</span>(pi, omega<span class="sc">*</span>(kappa<span class="dv">-2</span>)<span class="sc">+</span><span class="dv">1</span>, (<span class="dv">1</span><span class="sc">-</span>omega)<span class="sc">*</span>(kappa<span class="dv">-2</span>)<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb2-4"><a></a>         <span class="at">prior =</span> p_pi_given_omega <span class="sc">*</span> p_omega)</span>
<span id="cb2-5"><a></a></span>
<span id="cb2-6"><a></a>plot_prior <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior) <span class="sc">+</span></span>
<span id="cb2-7"><a></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi, <span class="at">y=</span>omega, <span class="at">fill=</span>prior)) <span class="sc">+</span></span>
<span id="cb2-8"><a></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(pi), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2-11"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(omega), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2-12"><a></a>  viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>()</span>
<span id="cb2-13"><a></a></span>
<span id="cb2-14"><a></a>plot_prior_omega <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior) <span class="sc">+</span></span>
<span id="cb2-15"><a></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>omega, <span class="at">y=</span>p_omega))</span>
<span id="cb2-16"><a></a></span>
<span id="cb2-17"><a></a>plot_prior_pi_omega1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior <span class="sc">|&gt;</span> <span class="fu">filter</span>(omega <span class="sc">==</span> <span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb2-18"><a></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi, <span class="at">y=</span>prior)) <span class="sc">+</span></span>
<span id="cb2-19"><a></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(pi))</span>
<span id="cb2-20"><a></a></span>
<span id="cb2-21"><a></a>plot_prior_pi_omega2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior <span class="sc">|&gt;</span> <span class="fu">filter</span>(omega <span class="sc">==</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb2-22"><a></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi, <span class="at">y=</span>prior)) <span class="sc">+</span></span>
<span id="cb2-23"><a></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(pi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-7" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="section-8" class="slide level2 smaller">
<h2></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>likelihood <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">pi =</span> pi, <span class="at">omega =</span> omega) <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(y, <span class="at">size =</span> N, <span class="at">prob =</span> pi))</span>
<span id="cb3-3"><a></a></span>
<span id="cb3-4"><a></a>plot_likelihood <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(likelihood) <span class="sc">+</span></span>
<span id="cb3-5"><a></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi, <span class="at">y=</span>omega, <span class="at">fill=</span>likelihood)) <span class="sc">+</span></span>
<span id="cb3-6"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(pi), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb3-7"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(omega), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb3-8"><a></a>  viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>()</span>
<span id="cb3-9"><a></a></span>
<span id="cb3-10"><a></a>posterior <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(prior,likelihood) <span class="sc">|&gt;</span></span>
<span id="cb3-11"><a></a>  <span class="fu">mutate</span>(<span class="at">posterior =</span> prior <span class="sc">*</span> likelihood)</span>
<span id="cb3-12"><a></a></span>
<span id="cb3-13"><a></a>plot_posterior <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(posterior) <span class="sc">+</span></span>
<span id="cb3-14"><a></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi, <span class="at">y=</span>omega, <span class="at">fill=</span>posterior)) <span class="sc">+</span></span>
<span id="cb3-15"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(pi), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb3-16"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(omega), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb3-17"><a></a>  viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-9" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="section-10" class="slide level2">
<h2></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>pi <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb4-2"><a></a>omega <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb4-3"><a></a>A_omega <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb4-4"><a></a>B_omega <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb4-5"><a></a>kappa <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb4-6"><a></a>N <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb4-7"><a></a>y <span class="ot">&lt;-</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-11" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="section-12" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="section-13" class="slide level2">
<h2></h2>
<p>La inferencia bayesiana en un modelo jerárquico es inferencia en el espacio de la distribución conjunta de los parámetros pero reformulando la distribución conjunta en términos jerárquicos: se refactoriza <span class="math inline">\(p(\pi,\omega)\)</span> como <span class="math inline">\(p(\pi\mid\omega)p(\omega)\)</span></p>
</section>
<section id="extensión" class="slide level2 smaller">
<h2>Extensión</h2>
<p>¿Qué pasaría si contamos con más de una moneda creada por la misma fábrica? Cada moneda tiene un valor de <span class="math inline">\(\pi_s\)</span> que es propio y que a su vez tienen algo en común: provienen de la fábrica que tiene parámetro <span class="math inline">\(\omega\)</span>.</p>
<p>Con <span class="math inline">\(y_1\)</span> caras en <span class="math inline">\(N_1\)</span> tiradas de la moneda 1 estimamos <span class="math inline">\(\pi_1\)</span>, con <span class="math inline">\(y_2\)</span> caras en <span class="math inline">\(N_2\)</span> tiradas de la moneda 1 estimamos <span class="math inline">\(\pi_2\)</span>… y luego, con todas las tiradas, podemos estimar <span class="math inline">\(\omega\)</span>.</p>
</section>
<section id="section-14" class="slide level2 smaller">
<h2></h2>
<p>Consideremos un caso real. <span class="math inline">\(S\)</span> personas reciben una droga y son sometidos a un test de memoria. La probabilidad de que el sujeto <span class="math inline">\(s\)</span> recuerde un ítem que se le muestra es <span class="math inline">\(\pi_s\)</span>. El sujeto <span class="math inline">\(s\)</span> recuerda <span class="math inline">\(y_s\)</span> ítems de <span class="math inline">\(N_s\)</span> que se le presentan. Asumimos que la droga induce un efecto en los sujetos alrededor de una tendencia central <span class="math inline">\(\omega\)</span>.</p>
<p>Consideremos por simplicidad que se tienen dos sujetos…</p>
<p>¿Cuántos parámetros tiene el modelo? ¿Cómo podemos representar la relación entre los <span class="math inline">\(\theta_s\)</span>?</p>
</section>
<section id="section-15" class="slide level2 smaller">
<h2></h2>
<p><span class="math display">\[
\begin{align*}
    y_s\mid\pi_s &amp; \sim  \mathrm{Bi}(N_s,\pi_s)\\
    \pi_s \mid \omega &amp; \sim  \mathrm{Beta}(\omega(\kappa-2)+1,\ (1-\omega)(\kappa-2)+1) \\
    \omega &amp; \sim \mathrm{Beta}(A_\omega,B_\omega)
\end{align*}
\]</span></p>
<p>Si fijo <span class="math inline">\(\omega\)</span>, los valores de los <span class="math inline">\(\pi_s\)</span> son independientes: <span class="math inline">\(\pi_1\)</span> y <span class="math inline">\(\pi_2\)</span> son independientes dado <span class="math inline">\(\omega\)</span>.</p>
<p>La probabilidad <em>a priori</em> que es <span class="math inline">\(p(\pi_1,\pi_2,\omega)\)</span> ahora puede factorizarse como <span class="math inline">\(p(\pi_1,\pi_2\mid \omega) p(\omega) = p(\pi_1\mid \omega) p(\pi_2\mid \omega) p(\omega)\)</span></p>
</section>
<section id="section-16" class="slide level2">
<h2></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>pi_1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb5-2"><a></a>pi_2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb5-3"><a></a>omega <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb5-4"><a></a>A_omega <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb5-5"><a></a>B_omega <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb5-6"><a></a>kappa <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb5-7"><a></a>N_1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb5-8"><a></a>y_1 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb5-9"><a></a>N_2 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb5-10"><a></a>y_2 <span class="ot">&lt;-</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-17" class="slide level2">
<h2></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>prior <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">pi_1 =</span> pi_1, <span class="at">pi_2 =</span> pi_2, <span class="at">omega =</span> omega) <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-3"><a></a>    <span class="at">p_omega =</span> <span class="fu">dbeta</span>(omega, A_omega, B_omega),</span>
<span id="cb6-4"><a></a>    <span class="at">p_pi1_given_omega =</span> <span class="fu">dbeta</span>(pi_1, </span>
<span id="cb6-5"><a></a>                              omega<span class="sc">*</span>(kappa<span class="dv">-2</span>)<span class="sc">+</span><span class="dv">1</span>, </span>
<span id="cb6-6"><a></a>                              (<span class="dv">1</span><span class="sc">-</span>omega)<span class="sc">*</span>(kappa<span class="dv">-2</span>)<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb6-7"><a></a>    <span class="at">p_pi2_given_omega =</span> <span class="fu">dbeta</span>(pi_2, </span>
<span id="cb6-8"><a></a>                              omega<span class="sc">*</span>(kappa<span class="dv">-2</span>)<span class="sc">+</span><span class="dv">1</span>, </span>
<span id="cb6-9"><a></a>                              (<span class="dv">1</span><span class="sc">-</span>omega)<span class="sc">*</span>(kappa<span class="dv">-2</span>)<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb6-10"><a></a>    <span class="at">prior =</span> p_pi1_given_omega <span class="sc">*</span>  p_pi2_given_omega <span class="sc">*</span> p_omega)</span>
<span id="cb6-11"><a></a></span>
<span id="cb6-12"><a></a>prior_pi1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior <span class="sc">|&gt;</span> </span>
<span id="cb6-13"><a></a>                      <span class="fu">group_by</span>(pi_1,omega) <span class="sc">|&gt;</span> </span>
<span id="cb6-14"><a></a>                      <span class="fu">summarise</span>(<span class="at">prior =</span> <span class="fu">sum</span>(prior))) <span class="sc">+</span></span>
<span id="cb6-15"><a></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi_1, <span class="at">y=</span>omega, <span class="at">fill=</span>prior)) <span class="sc">+</span></span>
<span id="cb6-16"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(pi[<span class="dv">1</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb6-17"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(omega), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb6-18"><a></a>  viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>()</span>
<span id="cb6-19"><a></a></span>
<span id="cb6-20"><a></a>prior_pi2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior <span class="sc">|&gt;</span> </span>
<span id="cb6-21"><a></a>                      <span class="fu">group_by</span>(pi_2,omega) <span class="sc">|&gt;</span> </span>
<span id="cb6-22"><a></a>                      <span class="fu">summarise</span>(<span class="at">prior =</span> <span class="fu">sum</span>(prior))) <span class="sc">+</span></span>
<span id="cb6-23"><a></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi_2, <span class="at">y=</span>omega, <span class="at">fill=</span>prior)) <span class="sc">+</span></span>
<span id="cb6-24"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(pi[<span class="dv">2</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb6-25"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(omega), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb6-26"><a></a>  viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-18" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="section-19" class="slide level2">
<h2></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>likelihood <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">pi_1 =</span> pi_1, <span class="at">pi_2 =</span> pi_2, <span class="at">omega =</span> omega) <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a></a>  <span class="fu">mutate</span>(<span class="at">likelihood_pi1 =</span> <span class="fu">dbinom</span>(y_1, <span class="at">size =</span> N_1, <span class="at">prob =</span> pi_1),</span>
<span id="cb7-3"><a></a>         <span class="at">likelihood_pi2 =</span> <span class="fu">dbinom</span>(y_2, <span class="at">size =</span> N_2, <span class="at">prob =</span> pi_2),</span>
<span id="cb7-4"><a></a>         <span class="at">likelihood =</span> likelihood_pi1 <span class="sc">*</span> likelihood_pi2)</span>
<span id="cb7-5"><a></a></span>
<span id="cb7-6"><a></a>likelihood1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(likelihood <span class="sc">|&gt;</span> </span>
<span id="cb7-7"><a></a>                        <span class="fu">group_by</span>(pi_1,omega) <span class="sc">|&gt;</span> </span>
<span id="cb7-8"><a></a>                        <span class="fu">summarise</span>(<span class="at">likelihood =</span> <span class="fu">sum</span>(likelihood))) <span class="sc">+</span></span>
<span id="cb7-9"><a></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi_1, <span class="at">y=</span>omega, <span class="at">fill=</span>likelihood)) <span class="sc">+</span></span>
<span id="cb7-10"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(pi[<span class="dv">1</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb7-11"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(omega), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb7-12"><a></a>  viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>()</span>
<span id="cb7-13"><a></a></span>
<span id="cb7-14"><a></a>likelihood2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(likelihood <span class="sc">|&gt;</span> </span>
<span id="cb7-15"><a></a>                        <span class="fu">group_by</span>(pi_2,omega) <span class="sc">|&gt;</span> </span>
<span id="cb7-16"><a></a>                        <span class="fu">summarise</span>(<span class="at">likelihood =</span> <span class="fu">sum</span>(likelihood))) <span class="sc">+</span></span>
<span id="cb7-17"><a></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi_2, <span class="at">y=</span>omega, <span class="at">fill=</span>likelihood)) <span class="sc">+</span></span>
<span id="cb7-18"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(pi[<span class="dv">2</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb7-19"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(omega), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb7-20"><a></a>  viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-20" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section id="section-21" class="slide level2">
<h2></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>posterior <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(prior, likelihood) <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a></a>  <span class="fu">mutate</span>(<span class="at">posterior =</span> prior <span class="sc">*</span> likelihood)</span>
<span id="cb8-3"><a></a></span>
<span id="cb8-4"><a></a>posterior_pi1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(posterior <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a></a>                          <span class="fu">group_by</span>(pi_1,omega) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a></a>                          <span class="fu">summarise</span>(<span class="at">posterior =</span> <span class="fu">sum</span>(posterior))) <span class="sc">+</span></span>
<span id="cb8-7"><a></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi_1, <span class="at">y=</span>omega, <span class="at">fill=</span>posterior)) <span class="sc">+</span></span>
<span id="cb8-8"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(pi[<span class="dv">1</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb8-9"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(omega), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb8-10"><a></a>  viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>()</span>
<span id="cb8-11"><a></a></span>
<span id="cb8-12"><a></a>posterior_pi2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(posterior <span class="sc">|&gt;</span> </span>
<span id="cb8-13"><a></a>                          <span class="fu">group_by</span>(pi_2,omega) <span class="sc">|&gt;</span> </span>
<span id="cb8-14"><a></a>                          <span class="fu">summarise</span>(<span class="at">posterior =</span> <span class="fu">sum</span>(posterior))) <span class="sc">+</span></span>
<span id="cb8-15"><a></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi_2, <span class="at">y=</span>omega, <span class="at">fill=</span>posterior)) <span class="sc">+</span></span>
<span id="cb8-16"><a></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(pi[<span class="dv">2</span>]), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb8-17"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(omega), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb8-18"><a></a>  viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>()</span>
<span id="cb8-19"><a></a></span>
<span id="cb8-20"><a></a>posterior_omega <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(posterior <span class="sc">|&gt;</span> </span>
<span id="cb8-21"><a></a>                            <span class="fu">group_by</span>(omega) <span class="sc">|&gt;</span> </span>
<span id="cb8-22"><a></a>                            <span class="fu">summarise</span>(<span class="at">posterior =</span> <span class="fu">sum</span>(posterior))) <span class="sc">+</span></span>
<span id="cb8-23"><a></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>omega, <span class="at">y=</span>posterior)) <span class="sc">+</span></span>
<span id="cb8-24"><a></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(omega))</span>
<span id="cb8-25"><a></a></span>
<span id="cb8-26"><a></a>posterior_pi1_marg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(posterior <span class="sc">|&gt;</span> </span>
<span id="cb8-27"><a></a>                               <span class="fu">group_by</span>(pi_1) <span class="sc">|&gt;</span> </span>
<span id="cb8-28"><a></a>                               <span class="fu">summarise</span>(<span class="at">posterior =</span> <span class="fu">sum</span>(posterior))) <span class="sc">+</span></span>
<span id="cb8-29"><a></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi_1, <span class="at">y=</span>posterior)) <span class="sc">+</span></span>
<span id="cb8-30"><a></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(pi[<span class="dv">1</span>]))</span>
<span id="cb8-31"><a></a></span>
<span id="cb8-32"><a></a>posterior_pi2_marg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(posterior <span class="sc">|&gt;</span> </span>
<span id="cb8-33"><a></a>                               <span class="fu">group_by</span>(pi_2) <span class="sc">|&gt;</span> </span>
<span id="cb8-34"><a></a>                               <span class="fu">summarise</span>(<span class="at">posterior =</span> <span class="fu">sum</span>(posterior))) <span class="sc">+</span></span>
<span id="cb8-35"><a></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>pi_2, <span class="at">y=</span>posterior)) <span class="sc">+</span></span>
<span id="cb8-36"><a></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(pi[<span class="dv">2</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-22" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section id="section-23" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-17-1.png" width="960" class="r-stretch"></section>
<section id="section-24" class="slide level2">
<h2></h2>
<ul>
<li class="fragment">La función de verosimilitud no depende de <span class="math inline">\(\omega\)</span></li>
<li class="fragment">La función de verosimilitud es más estrecha para el sujeto 1 que para el sujeto 2</li>
<li class="fragment">El <em>posterior</em> marginal de <span class="math inline">\(\pi_1\)</span> está cerca de la proporción muestral</li>
<li class="fragment">El <em>posterior</em> marginal de <span class="math inline">\(\pi_2\)</span> está cerca de la proporción muestral</li>
<li class="fragment">El <em>posterior</em> marginal de <span class="math inline">\(\pi_1\)</span> tiene menos incertidumbre que el de <span class="math inline">\(\pi_2\)</span></li>
</ul>
<div class="fragment">
<p>¿Qué ocurre si se cambia el valor de <span class="math inline">\(\kappa\)</span>?</p>
</div>
</section>
<section id="section-25" class="slide level2">
<h2></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>pi_1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb9-2"><a></a>pi_2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb9-3"><a></a>omega <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb9-4"><a></a>A_omega <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-5"><a></a>B_omega <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-6"><a></a>kappa <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb9-7"><a></a>N_1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb9-8"><a></a>y_1 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb9-9"><a></a>N_2 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb9-10"><a></a>y_2 <span class="ot">&lt;-</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-26" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"></section>
<section id="section-27" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section>
<section id="section-28" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="section-29" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="section-30" class="slide level2">
<h2></h2>
<p>El <em>posterior</em> marginal de <span class="math inline">\(\pi_2\)</span> se alejó de la proporción muestral. El sujeto 1 tenía un tamaño de muestra mayor (más evidencia) y por lo tanto influyó más en la estimación de <span class="math inline">\(\omega\)</span>, lo que a la vez influye en la estimación de <span class="math inline">\(\pi_2\)</span>.</p>
</section>
<section id="shrinkage" class="slide level2">
<h2>Shrinkage</h2>
<p>La estructura jerárquica de los modelos hace que las estimaciones de los parámetros de los niveles más bajos se acerquen más de lo que lo harían si no hubiera una distribución en un nivel superior. Esto es lo que se conoce como <em>shrinkage</em> de las estimaciones.</p>
<p>Las estimaciones de los parámetros de los niveles más bajos son tiradas (<em>pulled</em>) o se estrechan o tienden a concentrarse hacia la moda de la distribución superior.</p>
</section>
<section id="section-31" class="slide level2 smaller">
<h2></h2>
<p>El <em>shrinkage</em> ocurre porque los parámetros de los niveles bajos (los <span class="math inline">\(\pi_s\)</span>) son influenciados por:</p>
<div class="fragment">
<ol type="1">
<li class="fragment">El conjunto de datos que dependen directamente de ese parámetro</li>
<li class="fragment">Los parámetros de niveles más altos de los cuales dependen los parámetros de niveles más bajos (¡y que son afectados por todos los datos!)</li>
</ol>
</div>
<div class="fragment">
<p>Por ejemplo, sobre <span class="math inline">\(\pi_1\)</span> influyen <span class="math inline">\(y_1\)</span> y <span class="math inline">\(N_1\)</span> pero también <span class="math inline">\(\omega\)</span> (cuya estimación depende de <span class="math inline">\(\pi_2\)</span> y <span class="math inline">\(N_2\)</span>).</p>
</div>
<div class="fragment">
<p>Nota: el <em>shrinkage</em> es consecuencia exclusivamente de la estructura jerárquica (y no de la inferencia bayesiana). Existe en la teoría clásica de estimación (ver estimador de James-Stein)</p>
</div>
</section>
<section id="section-32" class="slide level2">
<h2></h2>

<img data-src="imgs/shrinkage.png" class="r-stretch"></section>
<section id="otro-ejemplo" class="slide level2">
<h2>Otro ejemplo</h2>
<p>El radón es un gas radioactivo y cancerígeno. Los productos de la desintegración del radón son también radioactivos y en altas concentraciones se sabe que producen cáncer de pulmón. Trabajaremos con datos de mediciones de radón en el estado de Minnesota. Se cuenta con mediciones en hogares de diferentes condados dentro del estado.</p>
</section>
<section id="section-33" class="slide level2">
<h2></h2>
<ol type="1">
<li class="fragment"><span class="math inline">\(i\)</span> es el índice de los hogares</li>
<li class="fragment"><span class="math inline">\(Y_i\)</span> es el nivel de radón (log radón) del hogar <span class="math inline">\(i\)</span></li>
<li class="fragment"><span class="math inline">\(j\)</span> (entre <span class="math inline">\(1\)</span> y <span class="math inline">\(J\)</span>) es el índice de los condados</li>
<li class="fragment"><span class="math inline">\(j[i] = \mathrm{county}[i]\)</span> es el condado al que pertenece el hogar <span class="math inline">\(i\)</span></li>
</ol>
</section>
<section id="section-34" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-24-1.png" width="960" class="r-stretch"></section>
<section id="section-35" class="slide level2">
<h2></h2>
<h3 class="smaller" id="complete-pooling">Complete pooling</h3>
<p><span class="math display">\[
\begin{align*}
    Y_i\mid\mu_i,\sigma &amp; \sim  \mathcal{N}(\mu_i,\sigma^2) \\
    \mu_i &amp; = \alpha  \\
    \alpha &amp; \sim  P(\alpha) \\
    \sigma &amp; \sim  P(\sigma)
\end{align*}
\]</span></p>
<p>Hay una única media <span class="math inline">\(\alpha\)</span> común para todos los <span class="math inline">\(i\)</span>, independientemente del grupo <span class="math inline">\(j\)</span> al que pertenezcan</p>
</section>
<section id="section-36" class="slide level2">
<h2></h2>
<h3 class="smaller" id="no-pooling">No pooling</h3>
<p><span class="math display">\[
\begin{align*}
    Y_i\mid\mu_i,\sigma &amp; \sim  \mathcal{N}(\mu_i,\sigma^2)\\
    \mu_i &amp; = \alpha_{j[i]}  \\
    \alpha_j &amp; \sim  P(\alpha_j) \\
    \sigma &amp; \sim  P(\sigma)
\end{align*}
\]</span></p>
<p>Decimos que los <span class="math inline">\(Y_i\)</span> tienen distribución de media <span class="math inline">\(\alpha_{j[i]}\)</span>, sin imponer ninguna restricción sobre los <span class="math inline">\(\alpha_j\)</span>. <span class="math inline">\(P(\alpha_j)\)</span> es una distribución no informativa (muy ancha y chata). Todos los <span class="math inline">\(\alpha_j\)</span> son independientes. Coincide con la estimación clásica que incluye una variable <em>dummy</em> para cada grupo.</p>
</section>
<section id="section-37" class="slide level2 smaller">
<h2></h2>
<p>Podemos mejorar el modelo anterior incorporando un prior que regularice los <span class="math inline">\(\alpha_j\)</span></p>
<p><span class="math display">\[\begin{align*}
    Y_i\mid\mu_i,\sigma &amp; \sim  \mathcal{N}(\mu_i,\sigma^2) \\
    \mu_i &amp; = \alpha_{j[i]}  \\
    \alpha_j &amp; \sim  \mathcal{N}(0,10) \\
    \sigma &amp; \sim  P(\sigma)
\end{align*}\]</span></p>
<p>0 y 10 son valores arbitrarios para la media y la varianza de la distribución <em>a priori</em> de los <span class="math inline">\(\alpha_j\)</span>. Los <span class="math inline">\(\alpha_j\)</span> dejan de poder ser estimados libremente. Hay <em>regularización</em> y tendemos a evitar el <em>overfitting</em>. Hay un <em>partial pooling</em>. Si en lugar de 10 se elige un valor más grande, tendemos a <em>no pooling</em>; si se elige un valor más chico, tendemos a <em>pooling completo</em></p>
</section>
<section id="section-38" class="slide level2">
<h2></h2>
<p>Mejor aún, podemos estimar el grado de regularización partir de los datos. ¿Cuánto <em>pooling</em> es necesario? Se estima a partir de los datos…</p>
<p><span class="math display">\[\begin{align*}
    Y_i\mid\mu_i,\sigma &amp; \sim  \mathcal{N}(\mu_i,\sigma^2) \\
    \mu_i &amp; = \alpha_{j[i]}  \\
    \alpha_j &amp; \sim  \mathcal{N}(\mu_\alpha,\sigma_\alpha^2) \\
    \sigma &amp; \sim  P(\sigma) \\
    \mu_\alpha &amp; \sim  P(\mu_\alpha) \\
    \sigma_\alpha &amp; \sim  P(\sigma_\alpha) \\
\end{align*}\]</span></p>
</section>
<section id="section-39" class="slide level2">
<h2></h2>
<p><span class="math inline">\(\mu_\alpha\)</span> y <span class="math inline">\(\sigma_\alpha\)</span> son hiperparámetros (parámetros de la distribución de <em>a priori</em> de los parámetros) y por lo tanto tienen <em>hiperpriors</em></p>
<p>El chiste es que <em>todos</em> los datos se usan para estimar <span class="math inline">\(\mu_\alpha\)</span> y <span class="math inline">\(\sigma_\alpha\)</span> y por lo tanto en la estimación de cada <span class="math inline">\(\alpha_j\)</span> hay información de todos los datos. La regularización es adaptativa (se aprende de los datos).</p>
</section>
<section id="shrinkage-1" class="slide level2">
<h2>Shrinkage</h2>
<ol type="1">
<li class="fragment">Siempre que hay regularización, hay <em>shrinkage</em> de parámetros.</li>
<li class="fragment">Los datos de un grupo ayudan en la estimación de los parámetros de los otros grupos (<em>partial pooling</em>: préstamo de información).</li>
<li class="fragment">Así, los grupos que tienen menor tamaño de muestra toman más información del resto de los grupos y el <em>shrinkage</em> es más intenso.</li>
</ol>
</section>
<section id="section-40" class="slide level2 smaller">
<h2></h2>
<ol type="1">
<li class="fragment"><em>Pooling completo</em>: hay una única media para todos los individuos, independientemente del grupo. La variación entre los grupos es cero. <em>Underfitting</em>.</li>
<li class="fragment"><em>No pooling</em>: cada grupo tiene una media independiente de la de los demás. La variación entre los grupos es infinita. No se comparte información entre los grupos, lo que se sabe de un grupo no ayuda a inferir sobre los demás. <em>Overfitting</em>.</li>
<li class="fragment"><em>Partial pooling</em>: cada grupo tiene una media pero todas las medias están conectadas. Es una solución de compromiso, un punto medio entre <em>pooling completo</em> y <em>no pooling</em>.</li>
</ol>
</section>
<section id="section-41" class="slide level2 smaller">
<h2></h2>
<p>Para algunos condados: a la izquierda está la estimación de la media <em>no pooling</em> de la media, a la derecha la estimación del modelo multinivel (<em>pooling parcial</em>). En línea de trazos el <em>pooling completo</em>.</p>

<img data-src="imgs/pooling_intercept_algunos.png" class="r-stretch"></section>
<section id="otro-ejemplo-1" class="slide level2">
<h2>Otro ejemplo</h2>
<p>Corredores que han participado varias veces de una famosa maratón en Washington. Se registraron los tiempos de los participantes.</p>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch"></section>
<section id="section-42" class="slide level2">
<h2></h2>

<img data-src="presentacion_08_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch"></section>
<section id="section-43" class="slide level2">
<h2></h2>

<img data-src="imgs/no_pooling_slope.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-44" class="slide level2">
<h2></h2>

<img data-src="imgs/partial_pooling_slope.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="section-45" class="slide level2">
<h2></h2>
<ul>
<li class="fragment">La información de la estimación de la pendiente de un grupo es útil para estimar las otras pendientes</li>
<li class="fragment">La información de la estimación de las ordenadas al origen de un grupo es útil para estimar las otras ordenadas al origen</li>
<li class="fragment">Las pendientes y las ordenadas al origen trabajan de forma conjunta para describir a un corredor, covarían</li>
</ul>
</section>
<section id="section-46" class="slide level2">
<h2></h2>
<p><span class="math display">\[\begin{align*}
    Y_i  \mid \mu_i,\sigma &amp; \sim  \mathcal{N}(\mu_i,\sigma^2) \\
    \mu_i &amp; = \alpha_{j[i]} + \beta_{j[i]} x_i \\
    \left[\begin{array}{c}\alpha_j\\\beta_j\end{array}\right] &amp; \sim \mathcal{N}\left(\left[\begin{array}{c}\mu_\alpha\\\mu_\beta\end{array}\right],\Sigma\right)
\end{align*}\]</span></p>
</section>
<section id="section-47" class="slide level2 smaller">
<h2></h2>
<p><span class="math inline">\(\left[\begin{array}{c}\alpha_j\\\beta_j\end{array}\right]\)</span> tienen una distribución conjunta, normal multivariada de hiperparámetros <span class="math inline">\(\left[\begin{array}{c}\mu_\alpha\\\mu_\beta\end{array}\right]\)</span> y <span class="math inline">\(\Sigma\)</span>. ¡Necesitan !</p>
<div class="fragment">
<p><span class="math inline">\(\Sigma\)</span> puede factorizarse según: </p>
<p><span class="math display">\[
\Sigma = \left( \begin{array}{cc} \sigma_\alpha^2 &amp; \sigma_\alpha\sigma_\beta\rho \\ \sigma_\alpha\sigma_\beta\rho &amp; \sigma_\beta^2 \end{array}\right) =
\left( \begin{array}{cc} \sigma_\alpha &amp; 0 \\ 0 &amp; \sigma_\beta \end{array}\right) \left( \begin{array}{cc} 1 &amp; \rho \\ \rho &amp; 1 \end{array}\right)
\left( \begin{array}{cc} \sigma_\alpha &amp; 0 \\ 0 &amp; \sigma_\beta \end{array}\right)
\]</span></p>
<p>Llamando <span class="math display">\[R = \left( \begin{array}{cc} 1 &amp; \rho \\ \rho &amp; 1 \end{array}\right)\]</span> solo habría que definir una distribución para <span class="math inline">\(\sigma_\alpha\)</span>, <span class="math inline">\(\sigma_\beta\)</span> y <span class="math inline">\(R\)</span> (o <span class="math inline">\(\rho\)</span>)</p>
</div>
</section>
<section id="section-48" class="slide level2 smaller">
<h2></h2>
<p>No es solo para modelos lineales… Se tienen 60 tanques con ranitas de la especie <em>Hyperolius viridiflavus</em>. Cada tanque <span class="math inline">\(i\)</span> de ellos contiene una cantidad inicial de renacuajos <span class="math inline">\(N_i\)</span>. Al cabo de unas semanas se observa el número <span class="math inline">\(S_i\)</span> de renacuajos que sobrevivieron en el tanque <span class="math inline">\(i\)</span>.</p>
<center>
<img data-src="imgs/frog.jpg" width="300">
</center>
</section>
<section id="section-49" class="slide level2">
<h2></h2>
<p>Se modeliza la probabilidad de supervivencia de cada tanque con una regresión logística:</p>
<p><span class="math display">\[\begin{align*}
    S_i  \mid p_i &amp; \sim  Binomial(N_i,p_i) \\
   \log\left( \frac{p_i}{1-p_i} \right) &amp; = \alpha_{i} \\
   \alpha_i &amp; \sim \mathcal{N}(\mu_\alpha,\sigma_\alpha^2)
\end{align*}\]</span></p>
<p>Observar que no hay grupos (no hay índice <span class="math inline">\(j\)</span>), simplemente hacemos de los individuos.</p>
</section>
<section id="section-50" class="slide level2 smaller">
<h2></h2>
<p>Comparamos la estimación de <span class="math inline">\(p_i = \frac{e^{\alpha_i}}{1+e^{\alpha_i}}\)</span> con la obtenida por máxima verosimilitud en cada tanque: <span class="math inline">\(p_{i,ML} = \frac{S_i}{N_i}\)</span></p>

<img data-src="imgs/pooling_ranas.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="intercambiabilidad" class="slide level2">
<h2>Intercambiabilidad</h2>
<p>Si no existe otra información más que los datos observados <span class="math inline">\(y_i\)</span> para distinguir a los individuos <span class="math inline">\(i\)</span> y estos no pueden ordenarse ninguna manera entonces se puede asumir una simetría de los parámetros. Se dice que los parámetros <span class="math inline">\(\theta_i\)</span> son <strong>intercambiables</strong> (<em>exchangeable</em>).</p>
<p>Si las observaciones pueden agruparse y los grupos son <em>indistinguibles</em> (con características propias desconocidas) con propiedades/particularidades ignoradas entonces los grupos son <strong>intercambiables</strong> y los individuos, <strong>parcialmente</strong> o <strong>condicionalmente intercambiables</strong>.</p>
</section>
<section id="distribuciones-predictivas" class="slide level2 smaller">
<h2>Distribuciones predictivas</h2>
<p>En los modelos jerárquicos hay <em>dos tipos</em> de distribuciones predictivas <em>a posteriori</em>:</p>
<ul>
<li class="fragment">Predicciones para individuos que pertenecen a grupos ya existentes (tiradas de la moneda con la que se realizaron las inferencias, otra tarea de memoria para un individuo que ya participó del experimento)</li>
<li class="fragment">Predicciones para individuos pertenecientes a grupos nuevos (tiradas de una nueva moneda de la fábrica, cómo afectaría la droga a un individuo nuevo)</li>
</ul>
</section>
<section id="resumen" class="slide level2 smaller">
<h2>Resumen</h2>
<ul>
<li class="fragment">Los modelos jerárquicos resultan atractivos para problemas en los cuales los parámetros se pueden considerar vinculados de cierta forma, por ejemplo en grupos.</li>
<li class="fragment">Los modelos jerárquicos o multinivel son extensiones de los modelos lineales (y de los modelos lineales generalizados) para datos que tienen algún grado de agrupamiento y en los cuales se permite que los parámetros varíen por grupo</li>
<li class="fragment">Los modelos multinivel permiten mejorar las inferencias en contextos donde la muestra es pequeña. Si un individuo que tiene pocas observaciones pertenece a un determinado grupo, se supone que compartirá características con otros individuos de ese grupo y por lo tanto la estimación de sus parámetros podrá ser informada por la de sus pares.</li>
</ul>

<div class="quarto-auto-generated-content">
<p><img src="../utils/imgs/logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>Estadística Bayesiana – 2024</p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/estadisticaunr\.github\.io\/estadistica-bayesiana\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>