---
title: "TP3: Una masacre estad√≠stica (WIP)"
practica: "Trabajo Pr√°ctico 3"
---

## Introducci√≥n

Como si la riqueza del idioma espa√±ol no fuera suficiente para expresar aquello que 
queremos decir, muy frecuentemente los argentinos recurrimos a palabras o expresiones que,
sin contexto, carecen de significado o transmiten algo completamente distinto al uso que 
les damos.

Si de palabras se trata, sobran los ejemplos: perro, bife, mango, cana, puchero, 
panqueque, pavo, chorro, bondi y rata son algunos de ellos. Tampoco escasean frases que, 
inevitablemente, confunden a aquellos que nunca han pisado suelo argento: tomar el palo,
hacer la cama, mandar fruta, comer vidrio, estar en pa√±ales, pararse de manos o sacar el 
cuero.

El presente trabajo pr√°ctico gira alrededor de una palabra clave: masacre. 
La palabra "masacre" se utiliza, generalmente, para referirse a la matanza violenta e 
indiscriminada de un gran n√∫mero de personas. Sin embargo, y siguiendo la l√≠nea de los 
p√°rrafos introductorios, no la vamos a usar por su significado mas obvio, aunque s√≠ por 
uno muy cercano.


## El caso üïµÔ∏è‚Äç‚ôÄÔ∏è

Comenzar una carrera en estad√≠stica puede llevarnos a lugares impensados (algunos dir√°n 
que se converge, casi seguramente, a un estado de m√°xima confusi√≥n). Quien puede dar 
prueba de esto es Guido, un estudiante de estad√≠stica que, habiendo siendo fan√°tico de
[_CSI: Crime Scene Investigations_](https://es.wikipedia.org/wiki/CSI:_Crime_Scene_Investigation), 
nunca imagin√≥ que iba a cumplir su sue√±o de formar parte la polic√≠a cient√≠fica de C√≥rdoba.

Pero no todo es color de rosas en el camino de Guido. Al poco tiempo de instalado en 
la capital del cuarteto, una madrugada de mi√©rcoles, su unidad de trabajo fue convocada
de manera urgente por el comisario de Salsipuedes para investigar una crimen que, 
aparentemente, hab√≠a sido reci√©n cometido.

¬°Qu√© masacre! Fue lo √∫nico que pudo a decir al llegar al lugar. 
El caos se extend√≠a por toda la habitaci√≥n.
Muebles volcados y destrozados. Utensillos de cocina desparramados y manchados con un
l√≠quido carmes√≠. La ventana, con sus vidrios estallados, daba paso a la brisa matutina 
y la d√©bil luz de los m√≥viles policiales que dejaban ver que, hacia un extremo del sal√≥n, 
el cuerpo de Sergio Contreras yac√≠a en un charco de sangre.

Abundan las tareas que los investigadores deben realizar en un crimen de estas 
caracter√≠sticas. Nuestro protagonista, Guido, qued√≥ encargado de determinar la hora 
en que se produjo la muerte. En un marco tan desolador, Guido se alegr√≥ de encontrarse,
al fin, frente a un caso de aplicaci√≥n basado en datos reales.

## La metodolog√≠a üìö

La medicina forense dispone de un gran abanico de m√©todos para estimar la hora del 
fallecimiento. Estos estudian diferentes caracter√≠sticas, como por ejemplo la rigidez 
corporal, la presencia de livideces (manchas en el cuerpo), el nivel de descomposici√≥n, 
etc. 

Una de las estrategias mas utilizadas se basa en el estudio de la temperatura corporal.
Durante las primeras horas despu√©s de la muerte ocurre el enfriamiento del cuerpo,
que se conoce como enfriamiento postmortem o _algor mortis_. 

<!-- Para entender como utilizar la temperatura para determinar la hora de muerte, primero 
necesitamos entender c√≥mo varia la temperatura de un cuerpo en funci√≥n del tiempo 
transcurrido. -->

La temperatura es una medida del grado de agitaci√≥n de las part√≠culas de un cuerpo. 
Un s√≥lido (o l√≠quido, o gas) est√° _m√°s caliente_ que otro si sus part√≠culas tienen 
(en promedio) mayor grado de agitaci√≥n. Sabemos por evidencia emp√≠rica que si un cuerpo se
pone en contacto con otro que tiene una temperatura menor, hay una transferencia de 
energ√≠a que hace que el primero se enfr√≠e y el segundo se caliente, hasta que alcanzan el 
denominado equilibrio t√©rmico.

De manera similar, esto es lo que ocurre con el cuerpo de Sergio que yace en el living
de su casa: en alg√∫n momento, llega al equilibrio t√©rmico con el ambiente. 
La salvedad necesaria ac√° es que, como el ambiente es grande, no aumenta su temperatura 
con la energ√≠a que pierde el cuerpo.

Ahora bien, el ritmo con el cual el cuerpo pierde energ√≠a no es constante. 
F√≠sicamente, mientras mayor sea la diferencia de temperatura entre dos cuerpos, m√°s r√°pido
fluir√° la energ√≠a (y m√°s r√°pido cambiar√° la temperatura). Si estudiamos la temperatura de
un cuerpo en funci√≥n del tiempo, notaremos que el ritmo con el que cambia decrece a
medida con el que transcurre el tiempo.

La lectura del p√°rrafo anterior deber√≠a permitir asociar el concepto de _ritmo de cambio_ 
con la noci√≥n matem√°tica de derivada. En efecto, la derivada de la temperatura respecto al
tiempo var√≠a con el tiempo. En otras palabras, la pendiente no es constante.

Las leyes que rigen el universo pueden muchas veces formularse en t√©rminos de lo que en 
matem√°tica se conoce como ecuaci√≥n diferencial. En este caso, la temperatura del cuerpo
de Segio satisface la siguiente ley:

$$
\frac{\mathrm{d}T(t)}{\mathrm{d}t} = r [T_{\text{amb}} - T(t)]
$$

donde $T_{\text{amb}}$ es la temperatura ambiente (un valor fijo y conocido), $r$ es una 
constante y $T(t)$ es la funci√≥n (en principio desconocida) que describe la temperatura 
del cuerpo en funci√≥n del tiempo.

No se trata de una ecuaci√≥n algebraica donde la soluci√≥n es un valor num√©rico sino de una 
ecuaci√≥n donde la soluci√≥n es una funci√≥n. Buscamos una funci√≥n $T(t)$ que satisfaga la 
ecuaci√≥n: su derivada debe cambiar con el valor que toma la funci√≥n.

Una funci√≥n que satisface esa ecuaci√≥n es:

$$
T(t) = T_{\text{amb}} + (T_i - T_{\text{amb}})e^{-rt}
$$ 

siendo $T_i$ la temperatura a la que est√° inicialmente el agua en el termo 
(un valor fijo y conocido).

   
## Bayes al rescate üé≤

**WIP**


1.  Verificar que la funci√≥n anterior satisface la ecuaci√≥n diferencial
2.  Grafique $T(t)$ para $T_{\text{amb}} = 20 \text{ C¬∞}$ y $T_i = 37 \text{ C¬∞}$, 
    para dos valores de $r$, $r_1=0.1$ y $r_2 = 0.3$. ¬øQu√© representa $r$?
3.  ~~Seg√∫n su experiencia con termos, ¬øcu√°l es un valor realista de $r$?~~ Dar alguna informaci√≥n
que diga a que hora el cuerpo en general ya est√° "frio"

Estudiaremos a continuaci√≥n un conjunto de mediciones de temperatura de agua en un termo 
en funci√≥n del tiempo transcurrido.

Leonel tiene un termo Estanli‚Ñ¢ que compr√≥ por Amason y se dispone a despejar la duda de 
cualquier usuario de termos Estanli‚Ñ¢: ¬øcu√°nto dura el agua caliente? Pone agua en la pava 
el√©ctrica, la vierte en el termo y registra la temperatura en algunos momentos posteriores.
Ese d√≠a, el reporte meteorol√≥gico indica una temperatura de $T_{\text{amb}} = 23\text{ C¬∞}$. 
Las temperaturas que registr√≥ Leonel son las siguientes:

```{r mediciones, echo=FALSE}
tabla <- data.frame(
    t = c("1:20", "2:30", "4:00", "5:15", "8:30"),
    T = c(92.0, 90.5, 81.4, 80.8, 74.2)
)
knitr::kable(tabla,col.names = c("t (h:mm)", "T (¬∞C)")) |> 
    kableExtra::kable_styling(full_width = FALSE)
```

Para simplificar la construcci√≥n de un modelo, en lugar de considerar la temperatura del 
agua en el termo, se considerar√° la diferencia entre la temperatura del agua y la 
temperatura ambiente $T-T_{\text{amb}}$. Adem√°s, se llamar√° $T_{\text{diff}}$ a la 
diferencia de temperatura entre la temperatura inicial del agua y la temperatura ambiente 
$T_i - T_{\text{amb}}$.

$$
T(t) - T_{\text{amb}} = T_{\text{diff}} e^{-rt}
$$

4.  Verifique que el logaritmo natural de la nueva variable ($T(t) - T_{\text{amb}}$) es 
    una funci√≥n lineal de $t$. ¬øQu√© representan el intercepto y la pendiente? Ll√°melos 
    $\beta_0$ y $\beta_1$.

Se propone ajustar un modelo lineal normal utilizando los datos transformados.

5.  En funci√≥n del enunciado del problema y de su conocimiento de termos, elija una 
    distribuci√≥n _a priori_ para $\beta_0$, $\beta_1$ y $\sigma$. ¬øCu√°les son las 
    implicancias de sus distribuciones _a priori_? Realice pruebas predictivas _a priori_.
6.  Ajuste el modelo lineal utilizando `R`.
7.  Encontrar el _posterior_ de $r$, de $T_{\text{diff}}$ y de la temperatura inicial del 
    agua $T_i$.
8.  Predecir la temperatura a la que estar√° el agua transcurridas 12:00 h del inicio de 
    la experiencia.




<!-- Bondi, Perro, Rata, Gato, Cana Mango, √ëoqui, Bot√≥n, Chorro, Gamba, Banana, Bife, Panqueque, Pavo, Picada, Puchero, Llantas -->

<!-- Tomar el palo, Estar en pa√±ales, Abrir el paraguas, Chupar medias, Hacer la cama, Mandar fruta, Comer vidrio, Pararse de manos, Vender humo, Sacar el cuero -->


<!-- 1.  Realice un an√°lisis exploratorio de los datos de ajuste del modelo (_train_) y 
proponga _priors_ vagos de acuerdo a la escala de los datos. Realice simulaciones 
predictivas _a priori_. -->


---

<!-- Necesitan saber cuando falleci√≥ el muerto, tienen toda la fe depositada en el,
pero Guido no lleg√≥ a cursar estad√≠stica bayesiana, y no sabe que hacer!

Si no lo resolvemos, me van a masacrar en la revision anual

Bueno, lo ayudamos?

El caso

* Llamada a la policia hecha por una persona que dice que su perro estuvo toreando durante
las ultimas X horas, por la noche, y que al salir al patio al mirar observo que estaba
todo abierto en lo del vecino, lo cual era raro.

* Toman la temperatura corporal (poner hora).

* Esperan que llegue Z unidad, algo asi. Nuevamente toman la temperatura corporal.

* Al llegar el cuerpo a la morgue policial, otar vez toman la temperatura corporal.

Idea: Poner horas a los eventos, sirve para dar mas informacion a priori.

* Pensar en los siguientes escenarios
    * La persona es sana
    * La persona esta enferma
    * El hecho ocurre un 9 de julio
    * El hecho ocurre un 9 de enero
    * Estaba todo abierto, todo cerrado. -->