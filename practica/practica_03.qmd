---
title: "Práctica - Unidad 3"
bibliography: ../references.bib
nocite: |
    @Martin2021, @Downey2021
pdf_file: https://github.com/estadisticaunr/estadistica-bayesiana/raw/pdf/practica/practica_03.pdf
---

::: {.content-visible when-format="html"}

[Descargar PDF]({{< meta pdf_file >}})

:::

## Métodos Computacionales

1.  Sea $X \sim \text{Normal}(\mu=3, \sigma=1.2)$. 
    i. Elabore un gráfico que permita visualizar la función de densidad de probabilidad 
    de $X$.
    i. ¿Cuál es la probabilidad de que $X$ sea menor a 2.5?
    i. ¿Cuál es la probabilidad de que $X$ sea mayor a 4?
    i. ¿Cuál es la probabilidad de que $X$ sea mayor 2 y menor 3?

1.  Sea $X \sim \text{Beta}(\alpha=10, \beta=2)$
    i. Elabore un gráfico que permita visualizar la función de densidad de probabilidad 
    de $X$.
    i. ¿Cuál es la probabilidad de que $X$ sea menor a 0.5?
    i. ¿Cuál es la probabilidad de que $X$ sea mayor a 0.8?
    i. ¿Cuál es la probabilidad de que $X$ sea mayor 0.25 y menor 0.75?

1.  Responda los dos puntos anteriores sin evaluar la función de densidad ni la función
    de distribución de las variables aleatorias mencionadas. Para eso genere muestras
    que provengan de las correspondientes distribuciones y utilícelas para responder las 
    preguntas mencionadas. Reflexione sobre las ventajas y desventajas de utilizar un 
    enfoque basado en la simulación para resolver problemas.

1.  En un problema determinado la distribución a posteriori de la parámetro de inteŕes
    $\alpha$ es $\Gamma(k=3, \theta=1.5)$, donde $k$ es el parámetro de forma y $\theta$ 
    es el parámetro de escala. Calcule la probabilidad de que $\alpha^2$ sea mayor a 10.
    <!-- https://stats.stackexchange.com/questions/154135/square-of-gamma-random-variable -->

1.  Sean $X$ e $Y$ dos variables aleatorias independientes con distribución uniforme en el
    intervalo $[0, 1]$. 

    i.  ¿Cuál es la probabilidad de que $X \le Y$?
    i.  Grafique los puntos muestreados coloreando de acuerdo a si la muestra satisface
    el evento antes mencionado o no.

1.  Una máquina que se utiliza para ensamblar teléfonos celulares en una fábrica en 
    Tierra del Fuego cuenta con tres componentes críticos para su funcionamiento. 
    Ante una falla en cualquiera de estos componentes, la máquina se detiene. 
    Las probabilidades de que estos elementos operen correctamente durante un día 
    cualquiera  son $p_1 = 0.8$, $p_2 = 0.9$ y $p_3 = 0.7$. 
    Responda las siguientes preguntas utilizando técnicas de simulación:

    i.  ¿Cuál es la probabilidad de que la máquina falle en el primer día de uso?
    i.  ¿Cuál es la probabilidad de que la máquina siga funcionando luego de 10 días?
    i.  ¿Cuál es la probabilidad de que la máquina falle en el día 7 de uso?
    i.  Sea $T=$ Cantidad de días que la máquina funciona ininterrumpidamente. 
    Grafique la función de probabilidad de $T$.

1.  Dos estudiantes de estadística deciden encontrarse en la fotocopiadora de la Facultad
    entre las 10 y las 11 de la mañana, eligiendo el tiempo de llegada al azar. 
    La estudiante A esperará 10 minutos luego de llegar. Si el estudiante B no llega en
    ese intervalo, se irá. Lo mismo hace el estudiante B, pero este decide esperar por
    14 minutos. ¿Cuál es la probabilidad de que se produzca el encuentro en la 
    fotocopiadora entre la estudiante A y el estudiante B?

1.  [Este tuit](https://twitter.com/pgroisma/status/1616137795180822528) propone un
    problema muy interesante. Una urna contiene una bola azul y una amarilla. 
    Se elije una bola al azar y se la vuelve a colocar junto con otra bola adicional 
    del mismo color. Se repite este proceso indefinidamente. 
    ¿Qué ocurre con la proporción de bolas azules en la urna a medida que 
    repetimos más y más veces?

    i. Tiende a 1/2
    i. Tiende a 0 ó a 1
    i. No se estabiliza
    i. Ninguna de las anteriores

    Escriba un programa en `R` para responder esta pregunta utilizando simulaciones.
    Genere gráficos que faciliten la comprensión del resultado.

1.  ¿Cuánto vale $\pi$?

    Imagine un círculo de radio $r$ y un cuadrado de lado $2r$, ambos centrados en el 
    mismo punto, que de manera arbitraria puede ser el punto $(0, 0)$. Obtenga muestras
    de una distribución uniforme en el plano $(x, y)$, cuyo dominio está acotado por 
    el cuadrado antes mencionado. Para cada muestra extraida, determine si se encuentra 
    dentro del círculo o no -- todos las muestras se encontrarán dentro del cuadrado. 
    Utilice esta información para estimar el valor de $\pi$.
    
    ```{r circulo-cuadrado-pi}
    #| warning: false
    #| echo: false
    #| fig.width: 4.5
    #| fig.height: 4.5
    #| fig.align: center
    library(ggplot2)

    centro <- c(0, 0)
    radio <- 1
    angulos <- seq(0, 2 * pi, length.out = 512)

    x_circulo <- centro[1] + radio * cos(angulos)
    y_circulo <- centro[2] + radio * sin(angulos)

    x_cuadrado <- c(
        seq(-1, 1, length.out = 128),
        rep(1, 128),
        seq(1, -1, length.out = 128),
        rep(-1, 128)
    )
    y_cuadrado <- c(
        rep(1, 128), 
        seq(1, -1, length.out = 128), 
        rep(-1, 128), 
        seq(-1, 1, length.out = 128)
    )

    x <- c(x_circulo)
    y <- c(y_circulo)
    figura <- rep(c("circulo", "cuadrado"), each = 512)
        
    df <- data.frame(x = x, y = y, figura = figura)
    ggplot(df) + 
        geom_hline(yintercept = 0, linetype = "dashed", color = "#999999") +
        geom_vline(xintercept = 0, linetype = "dashed", color = "#999999") +
        geom_path(aes(x = x, y = y), size = 1.5, color = "#0984C0") +
        geom_rect(
            xmin = -1, xmax = 1, ymin = -1, ymax = 1, 
            fill = NA, color = "#999999", size = 1.5
        )
    ```

    Datos útiles

    * Area de un círculo: $\pi \cdot r^2$.
    * Area de un cuadrado: $a^2$, donde $a$ es la longitud del lado.

1.  Se seleccionan dos puntos de manera uniforme e independiente dentro de un círculo. 
    ¿Cuál es la probabilidad de que la distancia entre dos puntos sea menor al radio?

    i.  Intentar hacer a mano?
    i.  Hacer con `R`
    i.  Crear visualización que permita comunicar los resultados

1.  En la Copa del Mundo de la FIFA 2014, Alemania jugó contra Brasil en la semifinal. 
    Los alemanes hicieron el primer gol a los 11 minutos y el segundo a los 23.
    Asuma que el tiempo entre goles sigue una distribución exponencial. 
    Elija una distribución _a priori_ para el tiempo entre goles (puede ser conjugada o no).
    En ese momento del partido,

    i. ¿Cuál es la distribución _a posteriori_ del tiempo entre goles de Alemania?
    i. ¿Cuántos goles cabría esperar que Alemania hiciera al finalizar los 90 minutos?
    i. ¿Cuál era la probabilidad de que Alemania hiciera más de 5 goles (cosa que ocurrió)?
    <!-- http://allendowney.github.io/ThinkBayes2/chap08.html -->

1.  Grid approximation para una _skew-normal_. Estimar los parámetros $\xi$ (posición), $\omega$ (escala) y $\alpha$ (asimetría).
    $$
    f(x) = \frac{2}{\omega} \phi\left(\frac{x-\xi}{\omega}\right)\Phi\left( \alpha \frac{x-\xi}{\omega} \right)
    $$
    <!-- https://en.wikipedia.org/wiki/Skew_normal_distribution -->
    
1.  Una compañía pesquera de Comodoro Rivadavia se encuentra probando un nuevo método para
    estimar el peso de los peces que extrae del Mar Argentino. El objetivo de este método
    es obtener una estimación lo suficientemente buena del peso de cada pescado sin tener
    que pesarlos uno por uno, ya que es un proceso costoso en tiempo y labor. 
    Para eso, seleccionaron una muestra de pescados, los pesaron
    y les midieron ciertos aspectos morfológicos (ancho, alto y largo). En el futuro,
    esperan recolectar estas mismas medidas morfológicas mediante una cámara especializada
    y utilizar el modelo para estimar el peso.
    
    El modelo propuesto por el equipo de investigación es el siguiente:

    $$
    \begin{aligned}
    \log(\text{Peso}_i) &\sim \text{Normal}(\mu, \sigma) \\
    \mu_i  &= \beta_0 + \beta_1 \log(\text{Largo}_i) \\
    \sigma &\sim \text{Gamma}(k, \theta)
    \end{aligned}
    $$

    El peso se encuentra medido en gramos y la longitud en centímetros. El equipo provee 
    las muestras que obtuvieron del _posterior_. Las mismas se pueden leer en `R` 
    utilizando el siguiente bloque de código. 

    ```{r}
    #| eval: false
    url <- paste0(
        "https://raw.githubusercontent.com/estadisticaunr/estadistica-bayesiana/",
        "main/datos/fish-market-posterior.csv"
    )
    df_posterior <- readr::read_csv(url)
    head(df_posterior)
    ```
    ```
    # A tibble: 6 × 3
      intercepto pendiente sigma
           <dbl>     <dbl> <dbl>
    1      -4.44      3.08 0.408
    2      -4.30      3.05 0.431
    3      -4.49      3.12 0.433
    4      -4.04      2.96 0.341
    5      -4.76      3.18 0.413
    6      -4.65      3.15 0.350
    ```

    i.  Analice de manera gráfica y analítica los _posteriors_ marginales de los 
    parámetros del modelo. Realice las transformaciones de parámetros que crea
    conveniente para facilitar la comprensión del análisis.
    i.  Considere un pescado cuya longitud es de 30 centímetros.
        a. Obtenga y grafique la distribución a posteriori del peso medio.
        a. Obtenga y grafique la distribución predictiva a posteriori del peso.
        a. Interprete los resultados. 
    i.  Grafique la curva de regresión junto a una banda de credibilidad del 95% en el
    plano de las variables transformadas y en el plano de las variables originales.
    i.  Agregue al gráfico anterior una banda de credibilidad del 95% para la distribución
    predictiva a posteriori. Interprete los resultados.
