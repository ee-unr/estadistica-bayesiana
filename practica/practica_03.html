<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Estadística Bayesiana - Práctica - Unidad 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../utils/imgs/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Estadística Bayesiana</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../info/programa.html">
 <span class="menu-text">Información</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../apuntes/introduccion.html">
 <span class="menu-text">Apuntes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../practica/practica_00.html" aria-current="page">
 <span class="menu-text">Práctica</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../trabajos_practicos/descripcion.html">
 <span class="menu-text">Trabajos Prácticos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../computo/instalacion.html">
 <span class="menu-text">Cómputo</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../complementario/probabilidad.html">
 <span class="menu-text">Material complementario</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/estadisticaunr/estadistica-bayesiana"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Práctica - Unidad 3</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_00.html" class="sidebar-item-text sidebar-link">Unidad 0</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_01.html" class="sidebar-item-text sidebar-link">Unidad 1</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_02.html" class="sidebar-item-text sidebar-link">Unidad 2</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_03.html" class="sidebar-item-text sidebar-link active">Unidad 3</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_04.html" class="sidebar-item-text sidebar-link">Unidad 4</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../practica/practica_05.html" class="sidebar-item-text sidebar-link">Unidad 5</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Práctica - Unidad 3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div>
<p><a href="https://github.com/estadisticaunr/estadistica-bayesiana/raw/pdf/practica/practica_03.pdf">Descargar PDF</a></p>
</div>
<section id="métodos-computacionales" class="level2">
<h2 class="anchored" data-anchor-id="métodos-computacionales">Métodos Computacionales</h2>
<ol type="1">
<li><p>Sea <span class="math inline">\(X \sim \text{Normal}(\mu=3, \sigma=1.2)\)</span>.</p>
<ol type="i">
<li>Elabore un gráfico que permita visualizar la función de densidad de probabilidad de <span class="math inline">\(X\)</span>.</li>
<li>¿Cuál es la probabilidad de que <span class="math inline">\(X\)</span> sea menor a 2.5?</li>
<li>¿Cuál es la probabilidad de que <span class="math inline">\(X\)</span> sea mayor a 4?</li>
<li>¿Cuál es la probabilidad de que <span class="math inline">\(X\)</span> sea mayor 2 y menor 3?</li>
</ol></li>
<li><p>Sea <span class="math inline">\(X \sim \text{Beta}(\alpha=10, \beta=2)\)</span></p>
<ol type="i">
<li>Elabore un gráfico que permita visualizar la función de densidad de probabilidad de <span class="math inline">\(X\)</span>.</li>
<li>¿Cuál es la probabilidad de que <span class="math inline">\(X\)</span> sea menor a 0.5?</li>
<li>¿Cuál es la probabilidad de que <span class="math inline">\(X\)</span> sea mayor a 0.8?</li>
<li>¿Cuál es la probabilidad de que <span class="math inline">\(X\)</span> sea mayor 0.25 y menor 0.75?</li>
</ol></li>
<li><p>Responda los dos puntos anteriores sin evaluar la función de densidad ni la función de distribución de las variables aleatorias mencionadas. Para eso genere muestras que provengan de las correspondientes distribuciones y utilícelas para responder las preguntas mencionadas. Reflexione sobre las ventajas y desventajas de utilizar un enfoque basado en la simulación para resolver problemas.</p></li>
<li><p>Una variable aleatoria <span class="math inline">\(X\)</span> toma valores en el conjunto <span class="math inline">\(\{2, 4, 6, 8, 10\}\)</span> con igual probabilidad. Encuentre la media y el desvío estándar de las variables <span class="math inline">\(X\)</span> e <span class="math inline">\(Y = 2X + 1\)</span>. <!-- Tal vez se puede hacer un poco más difícil si hacemos que la función sea no-lineal --></p></li>
<li><p>En un problema determinado la distribución a posteriori de la parámetro de inteŕes <span class="math inline">\(\alpha\)</span> es <span class="math inline">\(\Gamma(k=3, \theta=1.5)\)</span>, donde <span class="math inline">\(k\)</span> es el parámetro de forma y <span class="math inline">\(\theta\)</span> es el parámetro de escala. Calcule la probabilidad de que <span class="math inline">\(\alpha^2\)</span> sea mayor a 10. <!-- https://stats.stackexchange.com/questions/154135/square-of-gamma-random-variable --></p></li>
<li><p>Sean <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> dos variables aleatorias independientes con distribución uniforme en el intervalo <span class="math inline">\([0, 1]\)</span>.</p>
<ol type="i">
<li>¿Cuál es la probabilidad de que <span class="math inline">\(X \le Y\)</span>?</li>
<li>Grafique los puntos muestreados coloreando de acuerdo a si la muestra satisface el evento antes mencionado o no.</li>
</ol></li>
<li><p>Dos estudiantes de estadística deciden encontrarse en la fotocopiadora de la Facultad entre las 10 y las 11 de la mañana, eligiendo el tiempo de llegada al azar. La estudiante A esperará 10 minutos luego de llegar. Si el estudiante B no llega en ese intervalo, se irá. Lo mismo hace el estudiante B, pero este decide esperar 14 minutos. ¿Cuál es la probabilidad de que se produzca el encuentro en la fotocopiadora entre la estudiante A y el estudiante B?</p></li>
<li><p>Una máquina que se utiliza para ensamblar teléfonos celulares en una fábrica en Tierra del Fuego cuenta con tres componentes críticos para su funcionamiento. Ante una falla en cualquiera de estos componentes, la máquina se detiene. Las probabilidades de que estos elementos operen correctamente durante un día cualquiera son <span class="math inline">\(p_1 = 0.8\)</span>, <span class="math inline">\(p_2 = 0.9\)</span> y <span class="math inline">\(p_3 = 0.7\)</span>. Responda las siguientes preguntas utilizando técnicas de simulación:</p>
<ol type="i">
<li>¿Cuál es la probabilidad de que la máquina falle en el primer día de uso?</li>
<li>¿Cuál es la probabilidad de que la máquina siga funcionando luego de 10 días?</li>
<li>¿Cuál es la probabilidad de que la máquina falle en el día 7 de uso?</li>
<li>Sea <span class="math inline">\(T=\)</span> Cantidad de días que la máquina funciona ininterrumpidamente. Grafique la función de densidad de probabilidad de <span class="math inline">\(T\)</span>.</li>
</ol></li>
<li><p><a href="https://twitter.com/pgroisma/status/1616137795180822528">Este tuit</a> propone un problema muy interesante. Una urna contiene una bola azul y una amarilla. Se elije una bola al azar y se la vuelve a colocar junto con otra bola adicional del mismo color. Se repite este proceso indefinidamente. ¿Qué ocurre con la proporción de bolas azules en la urna a medida que repetimos más y más veces?</p>
<ol type="i">
<li>Tiende a 1/2</li>
<li>Tiende a 0 ó a 1</li>
<li>No se estabiliza</li>
<li>Ninguna de las anteriores</li>
</ol>
<p>Escriba un programa en <code>R</code> para responder esta pregunta utilizando simulaciones. Genere gráficos que faciliten la comprensión del resultado.</p></li>
<li><p>¿Cuánto vale <span class="math inline">\(\pi\)</span>?</p>
<p>Imagine un círculo de radio <span class="math inline">\(r\)</span> y un cuadrado de lado <span class="math inline">\(2r\)</span>, ambos centrados en el mismo punto, que de manera arbitraria puede ser el punto <span class="math inline">\((0, 0)\)</span>. Obtenga muestras de una distribución uniforme en el plano <span class="math inline">\((x, y)\)</span>, cuyo dominio está acotado por el cuadrado antes mencionado. Para cada muestra extraida, determine si se encuentra dentro del círculo o no – todos las muestras se encontrarán dentro del cuadrado. Utilice esta información para estimar el valor de <span class="math inline">\(\pi\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="practica_03_files/figure-html/circulo-cuadrado-pi-1.png" class="img-fluid figure-img" width="432"></p>
</figure>
</div>
</div>
</div>
<p>Datos útiles</p>
<ul>
<li>Area de un círculo: <span class="math inline">\(\pi \cdot r^2\)</span>.</li>
<li>Area de un cuadrado: <span class="math inline">\(a^2\)</span>, donde <span class="math inline">\(a\)</span> es la longitud del lado.</li>
</ul></li>
<li><p>Se seleccionan dos puntos de manera uniforme e independiente dentro de un círculo. ¿Cuál es la probabilidad de que la distancia entre dos puntos sea menor al radio?</p>
<ol type="i">
<li>Intentar hacer a mano?</li>
<li>Resuelva el problema utilizando <code>R</code></li>
<li>Elabore una visualización que facilite la comunicación de los resultados</li>
</ol></li>
<li><p>En la Copa del Mundo de la FIFA 2014, Alemania jugó contra Brasil en la semifinal. Los alemanes hicieron el primer gol a los 11 minutos y el segundo a los 23. Asuma que el tiempo entre goles sigue una distribución exponencial. Elija una distribución <em>a priori</em> para el tiempo entre goles (puede ser conjugada o no). En ese momento del partido,</p>
<ol type="i">
<li>¿Cuál es la distribución <em>a posteriori</em> del tiempo entre goles de Alemania?</li>
<li>¿Cuántos goles cabría esperar que Alemania hiciera al finalizar los 90 minutos?</li>
<li>¿Cuál era la probabilidad de que Alemania hiciera más de 5 goles (cosa que ocurrió)? <!-- http://allendowney.github.io/ThinkBayes2/chap08.html --></li>
</ol></li>
<li><p><strong>¿Tendré que esperar mucho?</strong></p>
<p>El tiempo que un empleado de recursos humanos demora en hacer una entrevista tiene distribución exponencial con media 30 minutos. Los tiempos de duración de cada entrevista se pueden considerar independientes entre sí. Las entrevistas a postulantes para un trabajo están programadas cada 15 minutos, comenzando desde las 8. Es válido considerar que todos los postulantes llegan puntuales a su entrevista. Cuando la persona del turno de las 8:15 llega a la oficina</p>
<ol type="i">
<li>¿Cuál es la probabilidad de que tenga que esperar antes de ser entrevistada?</li>
<li>¿Cuál es el horario esperado al que terminará su entrevista? <!-- Modern Data Science with R --></li>
</ol></li>
<li><p><strong>¡Qué casualidad!</strong></p>
<p>Dos personas se conocen en la fila de embarque para un vuelo en un avión Airbus A330-300</p>
<ol type="i">
<li>¿Cuál es la probabilidad de que tengan asientos en la misma fila?</li>
<li>¿Cuál es la probabilidad de que estén sentados en asientos adyacentes?</li>
</ol></li>
<li><p><strong>El Problema de Monty Hall</strong></p>
<p>El Problema de Monty Hall es un problema de probabilidad basado en un juego del concurso televisivo estadounidense “Trato hecho”. En este problema, el concursante debe elegir una puerta entre tres, todas cerradas. El premio consiste en llevarse lo que se encuentra detrás de la elegida. Se sabe con certeza que tras una de ellas se oculta un automóvil, y tras las otras dos hay cabras. Una vez que el concursante haya elegido una puerta y comunicado su elección a los presentes, el presentador, que sabe lo que hay detrás de cada puerta, abrirá una de las otras dos en la que haya una cabra. A continuación, le da la opción al concursante de cambiar, si lo desea, de puerta (tiene dos opciones). ¿Debe el concursante mantener su elección original o escoger la otra puerta? ¿Hay alguna diferencia? Resuelva este ejercicio utilizando simulaciones. <!-- Modern Data Science with R --></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/monty_hall.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Las 3 puertas del problema de Monty Hall</figcaption><p></p>
</figure>
</div>
</div>
</div></li>
<li><p><strong>Que los cumplan feliz</strong></p>
<p>Basándose en el <a href="https://twitter.com/Kit_Yates_Maths/status/1542767039814713346">siguiente tuit</a> y conociendo el problema del cumpleaños (¿cuántas personas debe haber en una habitación para que la probabilidad de que dos de ellas cumplan años el mismo día sea mayor a X%?) construir un gráfico similar al del tuit donde se grafique la probabilidad de que haya <span class="math inline">\(n\)</span> personas que cumplan años el mismo día para <span class="math inline">\(K\)</span> personas presentes en la habitación.</p></li>
<li><p><strong>Qué suerte, ¿no?</strong></p>
<p>Previo a la final de la Copa América 2021, los jugadores de la Selección Argentina se reúnen en la habitación del hotel como se describe en <a href="https://twitter.com/PlanetaDeCABJ/status/1587925636869300224">este tuit</a>.</p>
<ol type="i">
<li>¿Cuál es la probabilidad de que un jugador adivine una de diez cartas?</li>
<li>¿Cuál es la probabilidad de que tres de ellos adivinen una de diez cartas?</li>
</ol></li>
<li><p><strong>El álbum del Campeón</strong></p>
<p>El álbum oficial del Mundial de Fútbol de Qatar 2022 consta de 638 figuritas. Cada paquete trae cinco figuritas.</p>
<ol type="i">
<li>Comprando cinco paquetes, ¿cuál es la probabilidad de tener a Messi?</li>
<li>Comprando cinco paquetes, ¿cuál es la probabilidad de sacar a Messi repetido?</li>
<li>¿Cuántos paquetes se necesitan, en promedio, para completar el álbum?</li>
<li>Si a una persona le faltan diez figuritas para completar el álbum, ¿cuántos paquetes tiene que comprar para asegurarse de lograrlo?</li>
</ol></li>
<li><p><strong>¿Que tán raras son estas secuencias raras?</strong></p>
<p>Si se arroja una moneda <span class="math inline">\(n\)</span> veces, ¿cuál es la probabilidad de que no haya secuencias de <span class="math inline">\(k\)</span> caras?</p></li>
<li><p><strong>Un viaje por el elevador</strong></p>
<p>¿Cuál es la probabilidad de que tres personas en un ascensor con doce pisos presionen para ir a tres pisos consecutivos? ¿Qué supuestos realiza para resolver el problema? Escríbalos en una lista de manera explícita.</p></li>
<li><p><strong>La vida es muy corta como para perderla ordenando medias</strong></p>
<p>Un cajón contiene 10 pares de medias. No hay dos pares iguales. Por fiaca, el dueño de las medias no las agrupa después de lavarlas y simplemente las pone en el cajón. Al momento de necesitar un par de medias, saca una tras una hasta que se forma un par. En promedio, ¿cuántas medias sacará hasta encontrar un par? <!-- https://fivethirtyeight.com/features/can-you-find-a-matching-pair-of-socks/ --></p></li>
<li><p><strong>¿Vale la pena hacer un ensayo clínico a gran escala?</strong></p>
<p>Dados los resultados de un estudio piloto, la probabilidad <em>a posteriori</em> de que la droga desarrollada por tu compañía sea mas efectiva que el tratamiento actual es <span class="math inline">\(\theta \in [0, 1]\)</span>. Tu compañía está considerando realizar un ensayo clínico a gran escala para confirmar que la droga que desarrollan es de hecho mejor. El costo del estudio es <strong>$X</strong>. Si la droga es mejor, la probabilidad de que esto se confirme en el ensayo es del 80%. Si la droga no es mejor, hay una probabilidad del 5% de que el estudio confirme que es mejor. Si el ensayo sugiere que tu droga es mejor, ganarás <strong>$cX</strong>. ¿Para qué valores de <span class="math inline">\(\theta\)</span> y <span class="math inline">\(c\)</span> tiene sentido realizar el estudio? <!-- @Reich2020 --></p></li>
<li><p><strong>El problema de concordancia</strong></p>
<p>Resuelva el problema de concordancia de de Montmort presentado en la <strong>Práctica 0</strong> utilizando simulaciones. <!-- Blitzstein, Introdudction to Probability --></p></li>
<li><p><strong>El problema de los sobres</strong></p>
<p>Resuelva el problema de los dos sobres presentado en la <strong>Práctica 0</strong> utilizando simulaciones.</p></li>
</ol>
</section>
<section id="posteriors-aproximados" class="level2">
<h2 class="anchored" data-anchor-id="posteriors-aproximados"><em>Posteriors</em> aproximados</h2>
<p>Podriamos encontrar un mejor nombre…</p>
<ol type="1">
<li><p><strong>Aproximación de grilla</strong></p>
<p>Se tiene un experimento binomial donde <span class="math inline">\(n=80\)</span> y se observan <span class="math inline">\(y=7\)</span> éxitos. Considere que el <em>prior</em> de la probabilidad de éxito <span class="math inline">\(\theta\)</span> es <span class="math inline">\(\text{Beta}(2, 10)\)</span>.</p>
<ol type="i">
<li>Obtenga la distribución <em>a posteriori</em> de <span class="math inline">\(\theta\)</span> y grafíquela.</li>
<li>Obtenga la distribución <em>a posteriori</em> de <span class="math inline">\(\theta\)</span> utilizando el método de la grilla en base a una grilla de 10 puntos e incluya el resultado en el gráfico creado anteriormente.</li>
<li>Repita el proceso del punto anterior utilizando una grilla de 100 puntos.</li>
<li>Concluya sobre la fidelidad de las aproximaciones. ¿Considera que es necesario utilizar una grilla más densa? Describa ventajas y desventajas.</li>
</ol></li>
<li><p><strong>Cálculo de probabilidades en base a la grilla</strong></p>
<p>En base al <em>posterior</em> aproximado del ejercicio anterior calcule las siguientes probabilidades</p>
<ul>
<li><span class="math inline">\(P(\theta &lt; 0.7)\)</span></li>
<li><span class="math inline">\(P(\theta &gt; 0.05)\)</span></li>
<li><span class="math inline">\(P(0.05 &lt; \theta &lt; 0.15)\)</span></li>
</ul>
<p>De ser necesario, obtenga el <em>posterior</em> mediante una grilla de mayor densidad.</p></li>
<li><p><strong>Aproximación de grilla en 2 dimensiones</strong></p>
<p>Regresión univariada. Estimar el posterior de beta_0 y beta_1.</p></li>
<li><p><strong>Escalando la aproximación mediante grilla</strong></p>
<p><strong>WIP</strong></p>
<p>¿Cuántos puntos son necesarios para estimar un <em>posterior</em> por la aproximación de la grilla? Suponga que se usa una grilla de 500 puntos en cada dimensión.</p>
<ol type="i">
<li>1 dimensión</li>
<li>2 dimensiones</li>
<li>3 dimensiones</li>
<li>4 dimensiones</li>
</ol></li>
<li><p><strong><em>Benchmark</em></strong></p>
<ul>
<li>¿Algo del consumo de memoria y como eso se compara con las computadoras modernas?</li>
<li>¿Algo del tiempo que lleva calcular todos los puntos?</li>
<li>Moraleja: El numero de puntos, el consumo de memoria, y el tiempo computacional se incrementan exponencialmente.</li>
</ul></li>
<li><p><strong>La maldición de la dimensionalidad</strong></p>
<ul>
<li>Mostrar que casi todo el volumen de un hipercubo está en las esquinas.</li>
<li>Hablar de la distnacia a la moda en una normal multivariada conforme d -&gt; inftys</li>
<li>O tal vez es un tema de trabajo practico?</li>
</ul></li>
<li><p>Grid approximation para una <em>skew-normal</em>. Estimar los parámetros <span class="math inline">\(\xi\)</span> (posición), <span class="math inline">\(\omega\)</span> (escala) y <span class="math inline">\(\alpha\)</span> (asimetría). <span class="math display">\[
f(x) = \frac{2}{\omega} \phi\left(\frac{x-\xi}{\omega}\right)\Phi\left( \alpha \frac{x-\xi}{\omega} \right)
\]</span> <!-- https://en.wikipedia.org/wiki/Skew_normal_distribution --></p></li>
<li><p>Una compañía pesquera de Comodoro Rivadavia se encuentra probando un nuevo método para estimar el peso de los peces que extrae del Mar Argentino. El objetivo de este método es obtener una estimación lo suficientemente buena del peso de cada pescado sin tener que pesarlos uno por uno, ya que es un proceso costoso en tiempo y labor. Para eso, seleccionaron una muestra de pescados, los pesaron y les midieron ciertos aspectos morfológicos (ancho, alto y largo). En el futuro, esperan recolectar estas mismas medidas morfológicas mediante una cámara especializada y utilizar el modelo para estimar el peso.</p>
<p>El modelo propuesto por el equipo de investigación es el siguiente:</p>
<p><span class="math display">\[
\begin{aligned}
\log(\text{Peso}_i) &amp;\sim \text{Normal}(\mu, \sigma) \\
\mu_i  &amp;= \beta_0 + \beta_1 \log(\text{Largo}_i) \\
\sigma &amp;\sim \text{Gamma}(k, \theta)
\end{aligned}
\]</span></p>
<p>El peso se encuentra medido en gramos y la longitud en centímetros. El equipo provee las muestras que obtuvieron del <em>posterior</em>. Las mismas se pueden leer en <code>R</code> utilizando el siguiente bloque de código.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://raw.githubusercontent.com/estadisticaunr/estadistica-bayesiana/"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"main/datos/fish-market-posterior.csv"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>df_posterior <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(url)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_posterior)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code># A tibble: 6 × 3
  intercepto pendiente sigma
       &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1      -4.44      3.08 0.408
2      -4.30      3.05 0.431
3      -4.49      3.12 0.433
4      -4.04      2.96 0.341
5      -4.76      3.18 0.413
6      -4.65      3.15 0.350</code></pre>
<ol type="i">
<li>Analice de manera gráfica y analítica los <em>posteriors</em> marginales de los parámetros del modelo. Realice las transformaciones de parámetros que crea conveniente para facilitar la comprensión del análisis.</li>
<li>Considere un pescado cuya longitud es de 30 centímetros.
<ol type="a">
<li>Obtenga y grafique la distribución a posteriori del peso medio.</li>
<li>Obtenga y grafique la distribución predictiva a posteriori del peso.</li>
<li>Interprete los resultados.</li>
</ol></li>
<li>Grafique la curva de regresión junto a una banda de credibilidad del 95% en el plano de las variables originales y en el plano de las variables transformadas-</li>
<li>Agregue a los gráficos anteriores una banda de credibilidad del 95% para la distribución predictiva a posteriori. Interprete los resultados.</li>
</ol></li>
<li><p>Considere la siguiente familia de distribuciones normales en 2D</p>
<p><span class="math display">\[
f(\mathbf{x} | \pmb{\Sigma}, \pmb{\mu} = \mathbf{0})
= \frac{1}{\det(2\pi\pmb{\Sigma})^{-\frac{1}{2}}}
\exp[{-\frac{1}{2} \mathbf{x}^T \pmb{\Sigma}^{-1} \mathbf{x}}]
\]</span></p>
<p>y las siguientes matrices de covarianza</p>
<p><span class="math display">\[
\begin{array}{c}
    \pmb{\Sigma}_1 = \begin{bmatrix}
    1 &amp; 0 \\ 0 &amp; 1
    \end{bmatrix}
    &amp;
    \pmb{\Sigma}_2 = \begin{bmatrix}
    1 &amp; 0.2 \\ 0.2 &amp; 1
    \end{bmatrix}
    \\ \\
    \pmb{\Sigma}_1 = \begin{bmatrix}
    1 &amp; 0.5 \\ 0.5 &amp; 1
    \end{bmatrix}
    &amp;
    \pmb{\Sigma}_2 = \begin{bmatrix}
    0.1 &amp; 0 \\ 0 &amp; 1
    \end{bmatrix}
    \\ \\
    \pmb{\Sigma}_1 = \begin{bmatrix}
    1 &amp; 0.9 \\ 0.9 &amp; 1
    \end{bmatrix}
    &amp;
    \pmb{\Sigma}_2 = \begin{bmatrix}
    0.01 &amp; 0 \\ 0 &amp; 1
    \end{bmatrix}
\end{array}
\]</span></p>
<p>Que dan lugar a las siguientes funciones de densidad:</p>
<div class="cell" data-layout-align="center" data-hash="practica_03_cache/html/plot-matrix-of-gaussians_532abb7d0fbf86944a943bd3af930630">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="practica_03_files/figure-html/plot-matrix-of-gaussians-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Parte 1:</strong> Metropolis-Hastings</p>
<ol type="i">
<li>Utilice el algoritmo Metropolis-Hastings para obtener <span class="math inline">\(n=10000\)</span> muestras de cada una de las distribuciones.</li>
<li>Calcule la probabilidad de aceptación.</li>
<li>Grafique la función de autocorrelación y calcule la cantidad de muestras efectivas.</li>
<li>Analice como varía la probabilidad de aceptación y la cantidad de muestras efectivas según las diferentes características de la distribución objetivo.</li>
<li>¿Cuáles son las ventajas y desventajas del algoritmo de Metropolis-Hastings según lo que puede concluir a partir de esta aplicación? Comente dificultades con las que se haya encontrado.</li>
</ol>
<p><strong>Parte 2:</strong> Hamiltonian Monte Carlo</p>
<ol type="i">
<li>Utilice el algoritmo HMC para obtener <span class="math inline">\(n=10000\)</span> muestras de cada una de las distribuciones.</li>
<li>Calcule la probabilidad de aceptación.</li>
<li>Grafique la función de autocorrelación y calcule la cantidad de muestras efectivas.</li>
<li>Analice como varía la probabilidad de aceptación y la cantidad de muestras efectivas según las diferentes características de la distribución objetivo.</li>
<li>¿Cuáles son las ventajas y desventajas del algoritmo de Metropolis-Hastings según lo que puede concluir a partir de esta aplicación? Comente dificultades con las que se haya encontrado.</li>
</ol>
<!-- **To Do** Proveer valores para los parámetros 'mu' y 'sigma'--></li>
<li><p>Torus? To Do</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> torus_logpdf(scale):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> logp(x):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> <span class="op">-</span>((<span class="dv">1</span> <span class="op">-</span> x.norm(<span class="dv">2</span>)) <span class="op">/</span> scale)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> logp</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf = np.exp(-((1 - np.linalg.norm(xs, axis=0)) / scale)**2)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ol>
<section id="ejercicios-que-faltan" class="level3">
<h3 class="anchored" data-anchor-id="ejercicios-que-faltan">Ejercicios que faltan</h3>
<ul>
<li>Benchmark del método de aproximación mediante grilla de puntos
<ul>
<li>Medir y comparar uso de memoria y tiempo computacional</li>
</ul></li>
<li>Utilizar MH para obtener muestras
<ul>
<li>Normal univariada</li>
<li>Gamma univariada</li>
<li>Beta univariada</li>
<li>Una función muy arbitraria y “no genérica”</li>
<li>Normal multivariada
<ul>
<li>Independiente</li>
<li>Con correlación moderada</li>
<li>Con alta correlación</li>
</ul></li>
</ul></li>
<li>Calcular medidas de diagnóstico sobre los casos anteriores
<ul>
<li>En algunos casos tenemos que sugerir que corran múltiples cadenas</li>
</ul></li>
<li>Utilizar MH para obtener el posterior
<ul>
<li>Utilizar casos de la práctica 2
<ul>
<li>Incluir algún caso donde no todos los parámetros vivan en <span class="math inline">\(\mathbb{R}\)</span></li>
</ul></li>
</ul></li>
<li>Utilizar HMC para la normal multivariada con correlación moderada y alta correlación</li>
<li>Utilizar HMC para los modelos donde se usó MH</li>
<li>Stan:
<ul>
<li>Escribir algunos modelos con Stan</li>
<li>Diferentes priors</li>
<li>Analizar posterior de manera grafica (marginales y conjuntas)</li>
<li>Calcular diagnosticos y analizar</li>
</ul></li>
<li>Algun caso donde los diagnosticos no den bien…
<ul>
<li>Puede ser cuando el HMC no esta bien tuneado</li>
<li>Pensar algunos otros (deberia buscar en cosas que he hecho)</li>
</ul></li>
<li>Algo con brms?</li>
</ul>
<p><strong>Nota:</strong> Para los que dicen “utilizar HMC” estaria bueno que proveamos una funcion que use HMC, sin que tengan que usar Stan.</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">Referencias</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Downey2021" class="csl-entry" role="doc-biblioentry">
Downey, Allen B. 2021. <em>Think Bayes: Bayesian Statistics in Python</em>. 2nd edition. O’Reilly Media. <a href="http://allendowney.github.io/ThinkBayes2/">http://allendowney.github.io/ThinkBayes2/</a>.
</div>
<div id="ref-Martin2021" class="csl-entry" role="doc-biblioentry">
Martin, Osvaldo A., Ravin Kumar, y Junpeng Lao. 2021. <em>Bayesian Modeling and Computation in Python</em>. 1st edition. Chapman; Hall/CRC.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-right">Esta página es hecha con ❤️ y <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>